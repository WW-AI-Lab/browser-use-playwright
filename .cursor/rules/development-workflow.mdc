---
description: 
globs: 
alwaysApply: false
---
# å¼€å‘å·¥ä½œæµå’Œæœ€ä½³å®è·µ

## å¼€å‘æµç¨‹

### åˆ†æ”¯ç®¡ç†ç­–ç•¥
```
main (ç”Ÿäº§åˆ†æ”¯)
â”œâ”€â”€ develop (å¼€å‘åˆ†æ”¯) 
â”‚   â”œâ”€â”€ feature/phase-2-executor (åŠŸèƒ½åˆ†æ”¯)
â”‚   â”œâ”€â”€ feature/phase-3-healer (åŠŸèƒ½åˆ†æ”¯)
â”‚   â””â”€â”€ hotfix/bug-fix (çƒ­ä¿®å¤åˆ†æ”¯)
```

### æäº¤è§„èŒƒ
ä½¿ç”¨ [Conventional Commits](mdc:https:/www.conventionalcommits.org) è§„èŒƒï¼š

```
<type>[optional scope]: <description>

[optional body]

[optional footer(s)]
```

**ç±»å‹è¯´æ˜**:
- `feat`: æ–°åŠŸèƒ½
- `fix`: ä¿®å¤bug
- `docs`: æ–‡æ¡£æ›´æ–°
- `style`: ä»£ç æ ¼å¼è°ƒæ•´
- `refactor`: é‡æ„ä»£ç 
- `test`: æ·»åŠ æˆ–ä¿®æ”¹æµ‹è¯•
- `chore`: æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨

**ç¤ºä¾‹**:
```bash
feat(recorder): æ·»åŠ Browser-Useå·¥ä½œæµå½•åˆ¶åŠŸèƒ½
fix(web): ä¿®å¤æ¨¡æ¿æ–‡ä»¶ç¼ºå¤±é—®é¢˜
docs(readme): æ›´æ–°å®‰è£…è¯´æ˜
```

### å¼€å‘é˜¶æ®µç®¡ç†
å‚è€ƒ [docs/todolist.md](mdc:docs/todolist.md) å’Œ [docs/development-plan.md](mdc:docs/development-plan.md)ï¼š

1. **Phase 0**: âœ… é¡¹ç›®åˆå§‹åŒ–å’Œç¯å¢ƒæ­å»º
2. **Phase 1**: âœ… å½•åˆ¶å’Œç¼–è¾‘åŠŸèƒ½å®ç°
3. **Phase 2**: ğŸ”„ æ‰§è¡ŒåŠŸèƒ½å®ç° (å½“å‰é˜¶æ®µ)
4. **Phase 3**: â³ Browser-Useè‡ªæ„ˆåŠŸèƒ½å®ç°
5. **Phase 4**: â³ CLIå·¥å…·å’Œç”¨æˆ·ç•Œé¢å®Œå–„
6. **Phase 5**: â³ æµ‹è¯•å®Œå–„å’Œæ–‡æ¡£ç¼–å†™

## ç¯å¢ƒç®¡ç†

### è™šæ‹Ÿç¯å¢ƒè®¾ç½®
```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv .venv

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ (macOS/Linux)
source .venv/bin/activate

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ (Windows)
.venv\Scripts\activate

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### ä¾èµ–ç®¡ç†
- ä½¿ç”¨ [requirements.txt](mdc:requirements.txt) ç®¡ç†ä¾èµ–
- æ–°å¢ä¾èµ–æ—¶åŒæ—¶æ›´æ–° requirements.txt
- å®šæœŸæ›´æ–°ä¾èµ–ç‰ˆæœ¬ï¼Œç¡®ä¿å®‰å…¨æ€§

### é…ç½®ç®¡ç†
- ä½¿ç”¨ [config.yml](mdc:config.yml) ç®¡ç†åº”ç”¨é…ç½®
- æ•æ„Ÿä¿¡æ¯é€šè¿‡ç¯å¢ƒå˜é‡ç®¡ç†
- ä¸åŒç¯å¢ƒä½¿ç”¨ä¸åŒçš„é…ç½®æ–‡ä»¶

## ä»£ç è´¨é‡ä¿è¯

### ä»£ç æ£€æŸ¥å·¥å…·
```bash
# ä»£ç æ ¼å¼åŒ–
black src/ tests/

# å¯¼å…¥æ’åº
isort src/ tests/

# ä»£ç æ£€æŸ¥
flake8 src/ tests/

# ç±»å‹æ£€æŸ¥
mypy src/
```

### é¢„æäº¤é’©å­
åˆ›å»º `.pre-commit-config.yaml`ï¼š
```yaml
repos:
  - repo: https://github.com/psf/black
    rev: 22.3.0
    hooks:
      - id: black
  - repo: https://github.com/pycqa/isort
    rev: 5.10.1
    hooks:
      - id: isort
  - repo: https://github.com/pycqa/flake8
    rev: 4.0.1
    hooks:
      - id: flake8
```

### æµ‹è¯•ç­–ç•¥
```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
pytest

# è¿è¡Œç‰¹å®šæµ‹è¯•æ¨¡å—
pytest tests/test_recorder.py

# è¿è¡Œè¦†ç›–ç‡æµ‹è¯•
pytest --cov=src tests/

# è¿è¡Œå¼‚æ­¥æµ‹è¯•
pytest -v tests/test_async_functions.py
```

## æ–‡æ¡£ç®¡ç†

### æ–‡æ¡£ç»“æ„
```
docs/
â”œâ”€â”€ development-plan.md      # å¼€å‘è§„åˆ’
â”œâ”€â”€ phase-0-bootstrap-plan.md # é˜¶æ®µ0è®¡åˆ’
â”œâ”€â”€ todolist.md             # ä»»åŠ¡æ¸…å•
â”œâ”€â”€ api-reference.md         # APIå‚è€ƒ (å¾…åˆ›å»º)
â”œâ”€â”€ user-guide.md           # ç”¨æˆ·æŒ‡å— (å¾…åˆ›å»º)
â””â”€â”€ deployment.md           # éƒ¨ç½²æŒ‡å— (å¾…åˆ›å»º)
```

### æ–‡æ¡£æ›´æ–°åŸåˆ™
1. ä»£ç å˜æ›´æ—¶åŒæ­¥æ›´æ–°ç›¸å…³æ–‡æ¡£
2. APIå˜æ›´æ—¶æ›´æ–°APIæ–‡æ¡£
3. æ–°åŠŸèƒ½å®Œæˆæ—¶æ›´æ–°ç”¨æˆ·æŒ‡å—
4. æ¯ä¸ªé˜¶æ®µå®Œæˆæ—¶æ›´æ–°å¼€å‘è§„åˆ’

### ä»£ç æ³¨é‡Šè§„èŒƒ
```python
class WorkflowRecorder:
    """å·¥ä½œæµå½•åˆ¶å™¨
    
    è´Ÿè´£ä½¿ç”¨Browser-Useè¿›è¡Œå·¥ä½œæµå½•åˆ¶ï¼Œç”ŸæˆJSONæ ¼å¼çš„å·¥ä½œæµæ–‡ä»¶ã€‚
    æ”¯æŒäº¤äº’å¼å½•åˆ¶å’Œå¼•å¯¼å¼å½•åˆ¶ä¸¤ç§æ¨¡å¼ã€‚
    
    Attributes:
        output_dir: å·¥ä½œæµè¾“å‡ºç›®å½•
        browser_config: æµè§ˆå™¨é…ç½®
        
    Example:
        >>> recorder = WorkflowRecorder()
        >>> workflow = await recorder.record_workflow("my_workflow")
    """
    
    async def record_workflow(self, name: str, mode: str = "interactive") -> Workflow:
        """å½•åˆ¶å·¥ä½œæµ
        
        Args:
            name: å·¥ä½œæµåç§°
            mode: å½•åˆ¶æ¨¡å¼ï¼Œ'interactive' æˆ– 'guided'
            
        Returns:
            Workflow: å½•åˆ¶å®Œæˆçš„å·¥ä½œæµå¯¹è±¡
            
        Raises:
            RecordingError: å½•åˆ¶è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯
        """
        pass
```

## è°ƒè¯•å’Œæ—¥å¿—

### æ—¥å¿—é…ç½®
ä½¿ç”¨ [src/utils/logger.py](mdc:src/utils/logger.py) è¿›è¡Œç»“æ„åŒ–æ—¥å¿—ï¼š

```python
import structlog

logger = structlog.get_logger(__name__)

# ä¸åŒçº§åˆ«çš„æ—¥å¿—
logger.debug("è°ƒè¯•ä¿¡æ¯", step_id=step.id)
logger.info("æ“ä½œæˆåŠŸ", workflow_name=name)
logger.warning("è­¦å‘Šä¿¡æ¯", message="æŸäº›æ¡ä»¶ä¸æ»¡è¶³")
logger.error("é”™è¯¯ä¿¡æ¯", error=str(e), traceback=True)
```

### è°ƒè¯•æŠ€å·§
```python
# ä½¿ç”¨æ–­ç‚¹è°ƒè¯•
import pdb; pdb.set_trace()

# å¼‚æ­¥ä»£ç è°ƒè¯•
import asyncio
import pdb

async def debug_async_function():
    pdb.set_trace()
    result = await some_async_operation()
    return result
```

## éƒ¨ç½²å’Œå‘å¸ƒ

### æœ¬åœ°å¼€å‘æœåŠ¡å™¨
```bash
# å¯åŠ¨Web UI
python scripts/start_web_ui.py

# ä½¿ç”¨CLIå·¥å…·
python -m src.cli.main --help

# è¿è¡Œæµ‹è¯•
python scripts/test_web_ui.py
```

### æ„å»ºå’Œæ‰“åŒ…
```bash
# æ„å»ºPythonåŒ…
python -m build

# åˆ›å»ºDockeré•œåƒ (å¾…å®ç°)
docker build -t gaia-rpa:latest .

# è¿è¡ŒDockerå®¹å™¨
docker run -p 8000:8000 gaia-rpa:latest
```

### ç‰ˆæœ¬ç®¡ç†
ä½¿ç”¨è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶ (SemVer)ï¼š
- `MAJOR.MINOR.PATCH`
- ä¾‹å¦‚: `1.0.0`, `1.1.0`, `1.1.1`

## åä½œå¼€å‘

### ä»£ç å®¡æŸ¥æ¸…å•
- [ ] ä»£ç ç¬¦åˆé¡¹ç›®ç¼–ç è§„èŒƒ
- [ ] åŒ…å«é€‚å½“çš„é”™è¯¯å¤„ç†
- [ ] æ·»åŠ äº†å¿…è¦çš„æµ‹è¯•
- [ ] æ›´æ–°äº†ç›¸å…³æ–‡æ¡£
- [ ] æ—¥å¿—è®°å½•å®Œæ•´
- [ ] æ€§èƒ½è€ƒè™‘åˆç†

### é—®é¢˜æŠ¥å‘Šæ¨¡æ¿
```markdown
## é—®é¢˜æè¿°
ç®€è¦æè¿°é‡åˆ°çš„é—®é¢˜

## å¤ç°æ­¥éª¤
1. æ‰§è¡Œå‘½ä»¤ `xxx`
2. è®¿é—®é¡µé¢ `xxx`
3. ç‚¹å‡»æŒ‰é’® `xxx`

## é¢„æœŸè¡Œä¸º
æè¿°æœŸæœ›çš„æ­£ç¡®è¡Œä¸º

## å®é™…è¡Œä¸º
æè¿°å®é™…å‘ç”Ÿçš„é”™è¯¯è¡Œä¸º

## ç¯å¢ƒä¿¡æ¯
- OS: macOS 12.0
- Python: 3.11.0
- Browser: Chrome 96.0

## é”™è¯¯æ—¥å¿—
```
ç²˜è´´ç›¸å…³çš„é”™è¯¯æ—¥å¿—
```

### åŠŸèƒ½è¯·æ±‚æ¨¡æ¿
```markdown
## åŠŸèƒ½æè¿°
æè¿°éœ€è¦çš„æ–°åŠŸèƒ½

## ä½¿ç”¨åœºæ™¯
è¯´æ˜è¿™ä¸ªåŠŸèƒ½çš„ä½¿ç”¨åœºæ™¯

## å»ºè®®å®ç°
æä¾›å®ç°å»ºè®®ï¼ˆå¯é€‰ï¼‰

## ç›¸å…³æ–‡æ¡£
é“¾æ¥åˆ°ç›¸å…³çš„æ–‡æ¡£æˆ–issue
```
